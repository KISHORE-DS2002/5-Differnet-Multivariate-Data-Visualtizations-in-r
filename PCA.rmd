---
title: "Principal Component Analysis - 19BCE1460"
output:
  pdf_document: default
  html_document: default
---
```{r}
library(readr)
library(psych)
library(factoextra)
require("datasets")
penguinsdata <- read.csv("S:/WIN SEM 21-22/Data Visualization/Lab/penguins_lter.csv")
penguinsdata <- na.omit(penguinsdata)
str(penguinsdata)
any(is.na.data.frame(penguinsdata))
shapiro.test(penguinsdata$CulmenLengthmm)
shapiro.test(penguinsdata$CulmenDepthmm)
shapiro.test(penguinsdata$FlipperLengthmm)
shapiro.test(penguinsdata$BodyMassg)
par(mfrow=(c(2,2)))
hist(penguinsdata$CulmenLengthmm)
hist(penguinsdata$CulmenDepthmm)
hist(penguinsdata$FlipperLengthmm)
hist(penguinsdata$BodyMassg)
penguinsdata_pca<-log(penguinsdata[,10:13])
penguinsdata_class<-(penguinsdata[,5])
pairs(penguinsdata_pca)
print(cortest.bartlett(cor(penguinsdata_pca), nrow(penguinsdata_pca)))
penguinsdata_comp<-prcomp(penguinsdata_pca,scale = T)
print(penguinsdata_comp)
biplot(penguinsdata_comp, scale = 0)
#PCA:Variance
plot(penguinsdata_comp,type="lines")
summary(penguinsdata_comp)
fviz_eig(penguinsdata_comp)

fviz_pca_ind(penguinsdata_comp,
             col.ind = "cos2", # Color by the quality of representation
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             repel = TRUE     # Avoid text overlapping
)
fviz_pca_var(penguinsdata_comp,
             col.var = "contrib", # Color by contributions to the PC
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             repel = TRUE     # Avoid text overlapping
)
fviz_pca_biplot(penguinsdata_comp, repel = TRUE,
                col.var = "#2E9FDF", # Variables color
                col.ind = "#696969"  # Individuals color
)
#Predict the PCs for new data
#Last two row of transformed penguins data
tail(penguinsdata_pca,2)
#Loading values of the PCs
print(penguinsdata_comp)
#PCs of last two rows of penguins data
PC1<-predict(penguinsdata_comp, newdata=tail(penguinsdata_pca, 2))
PC1  
cor_penguinsdata<-cor(penguinsdata_pca)
cor_penguinsdata
eigen_penguinsdata<-eigen(cor_penguinsdata)
eigen_penguinsdata$values
penguinsdata.var.prop<-eigen_penguinsdata$values/sum(eigen_penguinsdata$values)
penguinsdata.var.prop
eigen_penguinsdata$vectors

plot(eigen_penguinsdata$values, xlab = "Principal Component", ylab = "Eigen Values", type = "b")

plot(cumsum(penguinsdata.var.prop), xlab = "Principal Component", ylab = "Cumulative Eigen Values", type = "b")

#PCA using princomp()
penguinsdata_comp2<-princomp(penguinsdata[,10:13],scores=T)
penguinsdata_comp2$loadings
penguinsdata_comp2_scores<-penguinsdata_comp2$scores
head(penguinsdata_comp2_scores)


```

